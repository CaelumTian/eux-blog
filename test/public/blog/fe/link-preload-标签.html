<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Link Preload 标签 | 百度EUX </title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
<div id="root">
    <div class="main" data-reactroot="" data-reactid="1" data-react-checksum="405530912"><header class="clearfix eux-header" data-reactid="2"><div class="eux-header-top" data-reactid="3"><a href="javascript:void(0);" class="eux-portable-menu" data-reactid="4"></a><nav class="menu-primary-container" data-reactid="5"><ul id="menu-primary" class="menu" data-reactid="6"><li id="menu-item-25" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25" data-reactid="7"><a href="/" data-reactid="8">HOME</a></li><li id="menu-item-45" class="menu-item menu-item-type-custom menu-item-object-custom current-menu-ancestor current-menu-parent menu-item-has-children menu-item-45" data-reactid="9"><a href="/" data-reactid="10">BLOG</a><ul class="sub-menu" data-reactid="11"><li id="menu-item-63" class="menu-item menu-item-type-taxonomy menu-item-object-category current-menu-item menu-item-63" data-reactid="12"><a href="/ue" data-reactid="13">交互</a></li><li id="menu-item-67" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-67" data-reactid="14"><a href="/ui" data-reactid="15">视觉</a></li><li id="menu-item-64" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-64" data-reactid="16"><a href="/fe" data-reactid="17">前端</a></li><li id="menu-item-62" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-62" data-reactid="18"><a href="/team" data-reactid="19">团队</a></li></ul></li><li id="menu-item-46" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-46" data-reactid="20"><a href="/tools" data-reactid="21">TOOLS</a></li><li id="menu-item-112" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-112" data-reactid="22"><a href="/works" data-reactid="23">WORKS</a></li><li id="menu-item-138" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-138" data-reactid="24"><a href="/jobs" data-reactid="25">JOBS</a></li><li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50" data-reactid="26"><a href="/about-us" data-reactid="27">ABOUT US</a></li></ul></nav></div></header><div class="eux-singular clearfix" data-reactid="28"><div class="container-singular clearfix" data-reactid="29"><nav class="menu-categories-container" data-reactid="30"><ul id="menu-categories" class="menu" data-reactid="31"><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="32"><span data-reactid="33"><a href="/" data-reactid="34">全部</a></span></li><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="35"><span data-reactid="36"><a href="/ue" data-reactid="37">交互</a></span></li><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="38"><span data-reactid="39"><a href="/ui" data-reactid="40">视觉</a></span></li><li class="current-menu-item menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="41"><span data-reactid="42"><a href="/fe" data-reactid="43">前端</a></span></li><li class="menu-item menu-item-type-custom menu-item-object-custom current_page_item menu-item-55" data-reactid="44"><span data-reactid="45"><a href="/team" data-reactid="46">团队</a></span></li></ul></nav><div class="inner clearfix" data-reactid="47"><div class="article-meta" data-reactid="48"><h1 class="title" data-reactid="49">Link Preload 标签</h1><div class="eux-page-detail" data-reactid="50"><span data-reactid="51"><em data-reactid="52">by.</em><!-- react-text: 53 -->田 光宇<!-- /react-text --></span><span data-reactid="54">2017-8-28</span></div></div><article data-reactid="55"><p data-reactid="56">本文主要对 Preload 这一新标准介绍。目前 Preload 兼容性如下：  </p><!-- react-text: 57 -->
<!-- /react-text --><p data-reactid="58"><img src="https://raw.githubusercontent.com/T-phantom/T-phantom.github.io/master/images/preload_state.png" data-reactid="59"/></p><!-- react-text: 60 -->
<!-- /react-text --><h2 id="preload-标签是什么" data-reactid="61"><a href="#preload-%E6%A0%87%E7%AD%BE%E6%98%AF%E4%BB%80%E4%B9%88" aria-hidden="true" data-reactid="62"><span class="icon icon-link" data-reactid="63"></span></a><!-- react-text: 64 -->Preload 标签是什么<!-- /react-text --></h2><!-- react-text: 65 -->
<!-- /react-text --><p data-reactid="66">Preload 作为一个新的web标准，旨在提高性能和为web开发人员提供更细粒度的加载控制。Preload使开发者能够自定义资源的加载逻辑，且无需忍受基于脚本的资源加载器带来的性能损失。  </p><!-- react-text: 67 -->
<!-- /react-text --><pre data-reactid="68"><code data-query="{}" data-lang="data-lang" data-reactid="69">&lt;link rel=&quot;preload&quot;&gt;
</code></pre><!-- react-text: 70 -->
<!-- /react-text --><h2 id="类似的技术" data-reactid="71"><a href="#%E7%B1%BB%E4%BC%BC%E7%9A%84%E6%8A%80%E6%9C%AF" aria-hidden="true" data-reactid="72"><span class="icon icon-link" data-reactid="73"></span></a><!-- react-text: 74 -->类似的技术<!-- /react-text --></h2><!-- react-text: 75 -->
<!-- /react-text --><p data-reactid="76">关于预加载，目前已经有几种方案  </p><!-- react-text: 77 -->
<!-- /react-text --><h3 id="dns-prefetch" data-reactid="78"><a href="#dns-prefetch" aria-hidden="true" data-reactid="79"><span class="icon icon-link" data-reactid="80"></span></a><!-- react-text: 81 -->DNS prefetch<!-- /react-text --></h3><!-- react-text: 82 -->
<!-- /react-text --><p data-reactid="83">DNS prefetching通过指定具体的URL来告知客户端未来会用到相关的资源，这样浏览器可以尽早的解析DNS。比如我们需要一个在example.com的图片或者视频文件。在“就可以这么写：  </p><!-- react-text: 84 -->
<!-- /react-text --><pre data-reactid="85"><code data-query="{}" data-lang="data-lang" data-reactid="86">&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//example.com&quot;&gt;
</code></pre><!-- react-text: 87 -->
<!-- /react-text --><h3 id="preconnect" data-reactid="88"><a href="#preconnect" aria-hidden="true" data-reactid="89"><span class="icon icon-link" data-reactid="90"></span></a><!-- react-text: 91 -->Preconnect<!-- /react-text --></h3><!-- react-text: 92 -->
<!-- /react-text --><p data-reactid="93">和DNS prefetch类似，preconnect不光会解析DNS，还会建立TCP握手连接和TLS协议（如果需要）。用法如下：  </p><!-- react-text: 94 -->
<!-- /react-text --><pre data-reactid="95"><code data-query="{}" data-lang="data-lang" data-reactid="96">&lt;link rel=&quot;preconnect&quot; href=&quot;http://example.com&quot;&gt; 
</code></pre><!-- react-text: 97 -->
<!-- /react-text --><h3 id="prefetch" data-reactid="98"><a href="#prefetch" aria-hidden="true" data-reactid="99"><span class="icon icon-link" data-reactid="100"></span></a><!-- react-text: 101 -->Prefetch<!-- /react-text --></h3><!-- react-text: 102 -->
<!-- /react-text --><p data-reactid="103">当能确定网页在未来一定会使用到某个资源时，开发者可以让浏览器提前请求并且缓存好以供后续使用。prefetch支持预拉取图片、脚本或者任何可以被浏览器缓存的资源。  </p><!-- react-text: 104 -->
<!-- /react-text --><pre data-reactid="105"><code data-query="{}" data-lang="data-lang" data-reactid="106">&lt;link rel=&quot;prefetch&quot; href=&quot;image.png&quot;&gt;
</code></pre><!-- react-text: 107 -->
<!-- /react-text --><h3 id="subresource" data-reactid="108"><a href="#subresource" aria-hidden="true" data-reactid="109"><span class="icon icon-link" data-reactid="110"></span></a><!-- react-text: 111 -->Subresource<!-- /react-text --></h3><!-- react-text: 112 -->
<!-- /react-text --><p data-reactid="113">subresource可以用来指定资源是最高优先级的。比如，在Chrome和Opera中我们可以加上下面的代码：  </p><!-- react-text: 114 -->
<!-- /react-text --><pre data-reactid="115"><code data-query="{}" data-lang="data-lang" data-reactid="116">&lt;link rel=&quot;subresource&quot; href=&quot;styles.css&quot;&gt;  
</code></pre><!-- react-text: 117 -->
<!-- /react-text --><h3 id="prerender" data-reactid="118"><a href="#prerender" aria-hidden="true" data-reactid="119"><span class="icon icon-link" data-reactid="120"></span></a><!-- react-text: 121 -->Prerender<!-- /react-text --></h3><!-- react-text: 122 -->
<!-- /react-text --><p data-reactid="123">prerender是一个重量级的选项，它可以让浏览器提前加载指定页面的所有资源。  </p><!-- react-text: 124 -->
<!-- /react-text --><pre data-reactid="125"><code data-query="{}" data-lang="data-lang" data-reactid="126">&lt;link rel=&quot;prerender&quot; href=&quot;/thenextpage.html&quot;/&gt;
</code></pre><!-- react-text: 127 -->
<!-- /react-text --><h2 id="preload-的优势" data-reactid="128"><a href="#preload-%E7%9A%84%E4%BC%98%E5%8A%BF" aria-hidden="true" data-reactid="129"><span class="icon icon-link" data-reactid="130"></span></a><!-- react-text: 131 -->Preload 的优势<!-- /react-text --></h2><!-- react-text: 132 -->
<!-- /react-text --><p data-reactid="133">相对于类似的技术，Preload 有 as 属性，这让浏览器可做一些 subresource 和 prefetch 无法实现的事：  </p><!-- react-text: 134 -->
<!-- /react-text --><ul data-reactid="135"><!-- react-text: 136 -->
<!-- /react-text --><li data-reactid="137">浏览器可以设置正确的资源加载优先级</li><!-- react-text: 138 -->
<!-- /react-text --><li data-reactid="139">浏览器可以确保请求是符合内容安全策略的  </li><!-- react-text: 140 -->
<!-- /react-text --><li data-reactid="141">浏览器能根据 as 的值发送适当的 Accept 头部信息  </li><!-- react-text: 142 -->
<!-- /react-text --><li data-reactid="143">浏览器通过 as 值能得知资源类型  </li><!-- react-text: 144 -->
<!-- /react-text --></ul><!-- react-text: 145 -->
<!-- /react-text --><p data-reactid="146">Preload 的与众不同还体现在 onload 事件上（在 Chrome 中，prefetch 和 subresource 是不支持的）。preload 不会阻塞 windows 的 onload 事件，除非，preload资源的请求刚好来自于会阻塞 window 加载的资源。  </p><!-- react-text: 147 -->
<!-- /react-text --><h2 id="preload-用法举例" data-reactid="148"><a href="#preload-%E7%94%A8%E6%B3%95%E4%B8%BE%E4%BE%8B" aria-hidden="true" data-reactid="149"><span class="icon icon-link" data-reactid="150"></span></a><!-- react-text: 151 -->Preload 用法举例<!-- /react-text --></h2><!-- react-text: 152 -->
<!-- /react-text --><pre data-reactid="153"><code data-query="{}" data-lang="data-lang" data-reactid="154">&lt;link rel=&quot;preload&quot; href=&quot;a.js&quot; as=&quot;script&quot;&gt;
</code></pre><!-- react-text: 155 -->
<!-- /react-text --><p data-reactid="156">忽略 as 属性，或者错误的 as 属性会使 preload 等同于 XHR 请求，浏览器不知道加载的是什么，  </p><!-- react-text: 157 -->
<!-- /react-text --><p data-reactid="158">因此会赋予此类资源非常低的加载优先级。  </p><!-- react-text: 159 -->
<!-- /react-text --><h2 id="preload-应用" data-reactid="160"><a href="#preload-%E5%BA%94%E7%94%A8" aria-hidden="true" data-reactid="161"><span class="icon icon-link" data-reactid="162"></span></a><!-- react-text: 163 -->Preload 应用<!-- /react-text --></h2><!-- react-text: 164 -->
<!-- /react-text --><h3 id="对字体的提前加载" data-reactid="165"><a href="#%E5%AF%B9%E5%AD%97%E4%BD%93%E7%9A%84%E6%8F%90%E5%89%8D%E5%8A%A0%E8%BD%BD" aria-hidden="true" data-reactid="166"><span class="icon icon-link" data-reactid="167"></span></a><!-- react-text: 168 -->对字体的提前加载<!-- /react-text --></h3><!-- react-text: 169 -->
<!-- /react-text --><p data-reactid="170">字体被隐藏在css中间，浏览器有时候不能很好的将他们放入预加载器中，为此我们可以借助preload  </p><!-- react-text: 171 -->
<!-- /react-text --><pre data-reactid="172"><code data-query="{}" data-lang="data-lang" data-reactid="173">&lt;link rel=&quot;preload&quot; href=&quot;font.woff&quot; as=&quot;font&quot; type=&quot;font/woff&quot; crossorigin&gt;
</code></pre><!-- react-text: 174 -->
<!-- /react-text --><p data-reactid="175">crossorigin 属性是必须的，即便是字体资源在自家服务器上，因为用户代理必须采用匿名模式来获取字体资源。  </p><!-- react-text: 176 -->
<!-- /react-text --><h3 id="基于标记语言的异步加载" data-reactid="177"><a href="#%E5%9F%BA%E4%BA%8E%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80%E7%9A%84%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD" aria-hidden="true" data-reactid="178"><span class="icon icon-link" data-reactid="179"></span></a><!-- react-text: 180 -->基于标记语言的异步加载<!-- /react-text --></h3><!-- react-text: 181 -->
<!-- /react-text --><p data-reactid="182">css 异步加载  </p><!-- react-text: 183 -->
<!-- /react-text --><pre data-reactid="184"><code data-query="{}" data-lang="data-lang" data-reactid="185">&lt;link rel=&quot;preload&quot; as=&quot;style&quot; href=&quot;asyncstyle.css&quot; onload=&quot;this.rel=&#x27;stylesheet&#x27;&quot;&gt;
</code></pre><!-- react-text: 186 -->
<!-- /react-text --><p data-reactid="187">js 异步加载  </p><!-- react-text: 188 -->
<!-- /react-text --><pre data-reactid="189"><code data-query="{}" data-lang="data-lang" data-reactid="190">&lt;link rel=&quot;preload&quot; as=&quot;script&quot; href=&quot;async_script.js&quot; onload=&quot;var script = document.createElement(&#x27;script&#x27;); script.src = this.href; document.body.appendChild(script);&quot;&gt;
</code></pre><!-- react-text: 191 -->
<!-- /react-text --><p data-reactid="192">async 属性会阻塞 window 的 onload 事件，这么写就没有问题了。  </p><!-- react-text: 193 -->
<!-- /react-text --><h3 id="动态加载，但不执行" data-reactid="194"><a href="#%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%EF%BC%8C%E4%BD%86%E4%B8%8D%E6%89%A7%E8%A1%8C" aria-hidden="true" data-reactid="195"><span class="icon icon-link" data-reactid="196"></span></a><!-- react-text: 197 -->动态加载，但不执行<!-- /react-text --></h3><!-- react-text: 198 -->
<!-- /react-text --><pre data-reactid="199"><code data-query="{}" data-lang="data-lang" data-reactid="200">var link = document.createElement(&quot;link&quot;);
link.href = &quot;myscript.js&quot;;
link.rel = &quot;preload&quot;;
link.as = &quot;script&quot;;
document.head.appendChild(link);
var script = document.createElement(&quot;script&quot;);
script.src = &quot;myscript.js&quot;;
document.body.appendChild(script); 
</code></pre><!-- react-text: 201 -->
<!-- /react-text --><h2 id="检测是否支持-preload" data-reactid="202"><a href="#%E6%A3%80%E6%B5%8B%E6%98%AF%E5%90%A6%E6%94%AF%E6%8C%81-preload" aria-hidden="true" data-reactid="203"><span class="icon icon-link" data-reactid="204"></span></a><!-- react-text: 205 -->检测是否支持 preload<!-- /react-text --></h2><!-- react-text: 206 -->
<!-- /react-text --><p data-reactid="207">用下面的代码段可以检测是否被支持：  </p><!-- react-text: 208 -->
<!-- /react-text --><pre data-reactid="209"><code data-query="{}" data-lang="data-lang" data-reactid="210">const preloadSupported = () =&gt; {
    const link = document.createElement(&#x27;link&#x27;);
    const relList = link.relList;
    if (!relList || !relList.supports)
        return false;
    return relList.supports(&#x27;preload&#x27;);
};
</code></pre><!-- react-text: 211 -->
<!-- /react-text --><h2 id="preload-在生产环境的案例" data-reactid="212"><a href="#preload-%E5%9C%A8%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E7%9A%84%E6%A1%88%E4%BE%8B" aria-hidden="true" data-reactid="213"><span class="icon icon-link" data-reactid="214"></span></a><!-- react-text: 215 -->Preload 在生产环境的案例<!-- /react-text --></h2><!-- react-text: 216 -->
<!-- /react-text --><h3 id="treebo-案例" data-reactid="217"><a href="#treebo-%E6%A1%88%E4%BE%8B" aria-hidden="true" data-reactid="218"><span class="icon icon-link" data-reactid="219"></span></a><!-- react-text: 220 -->Treebo 案例<!-- /react-text --></h3><!-- react-text: 221 -->
<!-- /react-text --><p data-reactid="222">Treebo，印度最大的旅馆网站之一，在 3G 网络下对其桌面版试验，在对其顶部图片和主要的 Webpack 打包文件使用 preload 之后，在首屏绘制和可交互延迟分别减少了 1s。  </p><!-- react-text: 223 -->
<!-- /react-text --><p data-reactid="224"><img src="https://raw.githubusercontent.com/T-phantom/T-phantom.github.io/master/images/preload%E6%A1%88%E4%BE%8B1.png" data-reactid="225"/></p><!-- react-text: 226 -->
<!-- /react-text --><p data-reactid="227">同样的，在对自己的渐进式 Web 应用程序主要打包文件使用 preload 之后，Flipkart 在路由解析之前 节省了大量的主线程空闲时间（在 3G 网络下的低性能手机下）。  </p><!-- react-text: 228 -->
<!-- /react-text --><h1 id="参考文献" data-reactid="229"><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE" aria-hidden="true" data-reactid="230"><span class="icon icon-link" data-reactid="231"></span></a><!-- react-text: 232 -->参考文献<!-- /react-text --></h1><!-- react-text: 233 -->
<!-- /react-text --><ul data-reactid="234"><!-- react-text: 235 -->
<!-- /react-text --><li data-reactid="236"><a href="https://mp.weixin.qq.com/s/O5E2ASBEzfKOxgzCCJDlfw" data-reactid="237">深入研究Chrome：Preload与Prefetch原理，及其优先级</a><!-- react-text: 238 -->  <!-- /react-text --></li><!-- react-text: 239 -->
<!-- /react-text --><li data-reactid="240"><a href="https://www.smashingmagazine.com/2016/02/preload-what-is-it-good-for/" data-reactid="241">Preload: What Is It Good For?</a></li><!-- react-text: 242 -->
<!-- /react-text --></ul><!-- react-text: 243 -->
<!-- /react-text --></article><div data-reactid="244"><div class="valine-comment-container" data-reactid="245"></div></div><nav class="single-bar clearfix" data-reactid="246"><span class="prev" data-reactid="247"><a rel="prev" href="/blog/fe/xss攻击执行原理小结" data-reactid="248"><em class="eux-icon eux-icon-page-prev" data-reactid="249"></em><!-- react-text: 250 -->xss攻击执行原理小结<!-- /react-text --></a></span><span class="next" data-reactid="251"><a rel="next" href="/blog/fe/timing-api" data-reactid="252"><em class="eux-icon eux-icon-page-next" data-reactid="253"></em><!-- react-text: 254 -->Timing Api<!-- /react-text --></a></span></nav></div></div></div><footer class="footer" data-reactid="255"><div class="eux-footer-area-wrapper container-singular" role="complementary" data-reactid="256"><div class="inner clearfix" data-reactid="257"><aside id="simple-links-2" class="widget sl-links-main" data-reactid="258"><h2 class="widgettitle" data-reactid="259">友情链接</h2><ul class="simple-links-list simple-links-2-list" id="simple-links-2-list" data-reactid="260"><li class="simple-links-item simple-links-widget-item" id="link-379" data-reactid="261"><a href="http://sux.baidu.com" target="_blank" title="百度搜索用户体验中心" data-reactid="262">百度 SUX</a></li><li class="simple-links-item simple-links-widget-item" id="link-362" data-reactid="263"><a href="http://fex.baidu.com/" target="_blank" title="百度 FEX 团队" data-reactid="264">百度 FEX</a></li><li class="simple-links-item simple-links-widget-item" id="link-368" data-reactid="265"><a href="http://efe.baidu.com/" target="_blank" title="百度 EFE 团队" data-reactid="266">百度 EFE</a></li><li class="simple-links-item simple-links-widget-item" id="link-795" data-reactid="267"><a href="https://aotu.io/" target="_blank" title="京东凹凸实验室，面向多终端技术体系，致力于构建沉淀与分享包括但不限于交互、页面制作技巧、前端开发、原生APP开发等方面的专业知识及案例。" data-reactid="268">凹凸实验室</a></li></ul></aside><!-- react-text: 269 -->          <!-- /react-text --></div></div><div class="eux-icp" data-reactid="270"><!-- react-text: 271 -->百度EUX 版权所有 ©百度EUX    All rights reserved. 骄傲地采用 <!-- /react-text --><a target="_blank" href="https://github.com/picidaejs/picidaejs" data-reactid="272">Picidae</a><!-- react-text: 273 -->。<!-- /react-text --></div></footer></div>
</div>
<div>
</div>
<script src="/PICIDAE_COMMON.js"></script>
<script src="/PICIDAE_ENTRY.js"></script>
</body>
</html>